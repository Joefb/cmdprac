#!/bin/bash

# cmdprac
# Written by: Joe Burgess
# Checked by: shellcheck
#
# This script is used for practicing commands.
# The questions and answers are stored in arrays. They can be changed
# for any command you would like to practice.
# Be sure the indexes of the arrays match.

# global vars
Cm_nm="apt" ## change to name of command you are practicing

####### arrays ######### 
# questions
declare -a ques
ques=("Use apt to update the list of available packages and versions" 
      "Use apt to install vim and its dependencys"
      "Use apt to remove neovim and its config files"
      "Use apt to remove neovim but keep its config files"
      "Use apt to remove all unused packages but keep their configs"
      "Use apt to remove all unused packages and their config files"
      "Use apt to list all installed packages"
      "Use apt to list all installed packages that are upgradeable"
      "Use apt to list all available packages but grep for vim"
      "Use apt to upgrade the vim package"
      "Use apt to upgrade all installed packages"
      "Use apt to search all packages that contain the word vim"
      "Use apt to search all packages that start with the word vim"
      "Use apt to show detailed info on the vim package"
      "Use aptitude to show why the vim package is installed"
    )

# answers
declare -a answ
answ=("sudo apt update"
      "sudo apt install vim"
      "sudo apt purge neovim"
      "sudo apt remove neovim"
      "sudo apt autoremove"
      "sudo apt autoremove --purge"
      "sudo apt list --installed"
      "sudo apt list --upgradeable"
      "sudo apt list | grep vim" 
      "sudo apt upgrade vim"
      "sudo apt upgrade"
      "apt search vim"
      "apt search ^vim"
      "sudo apt show vim"
      "aptitude why vim"
    )

##### functions #######

# intro screen
intro_scrn() {
  clear
  toilet "${Cm_nm} command practice"
  echo "Welcome to cmdprac! This script will help you learn"
  echo "common ${Cm_nm} commands. Enjoy!"
  echo "Press enter to continue"
  read -r
  clear
  ask_quest
}

# exit screen
exit_scrn() {
  clear
  toilet "Good Job!"
  echo "Your ${Cm_nm} wizardry skills have increased!"
  echo "Would you like to try again? (y)es (n)o"
  read -r exita

  if [ "${exita}" == "y" ]; then
    clear
    toilet "WooHoo!"
    echo "Lets do some more ${Cm_nm} learning!"
    echo "Press enter to continue"
    read -r
    clear
    ask_quest

    else
      toilet "Have a good day!" 
    exit
  fi
}

ask_quest() {

  # ask question
  for idx in "${!ques[@]}"; do
    answr=""
    x=true
    y=3

    while [ "$x" == true ]; do
      echo
      echo  "${ques[$idx]}"
      read -r answr

      # check answer
      if [ "${answr}" == "${answ[idx]}" ]; then
        echo "Correct!"
        x=false
      else
          echo "Answer is not correct. Try again"
          ((y=y-1))
          echo "Tries left: " "${y}"
      fi

      # check number of tries and give answer 
      if [[ "$y" -eq 0 ]]; then
        echo
        echo "The correct answer is \"${answ[idx]}\""
        y=3
        echo "Press enter to try again"
        read -r
        clear
      fi
    done
  done
  exit_scrn
}

intro_scrn
